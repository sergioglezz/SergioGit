Ademas de `E_ALL` tenemos otras opciones muy interesantes como pueden ser `E_NOTICE`, la cual nos ayuda dandonos tambien consejos de buena sintaxis.

Por cierto, si estas utilizando **PHP 7.x** los mensajes de error que has tenido han sido diferentes, pero con el mismo significado. Eso es porque ahora ya no se notifican por el mecanismo tradicional, si no que lanzan excepciones `Error`

**Jerarquia de Error:**

* Throwable
  * Error
    * Arithmetic Error
  * DivisionByZeroError
* ParseError 
  * Exception

Todas las excepciones de **PHP** y las de usuario de **PHP7** siguen esta base:

```php
class Exception
{
    protected $message = 'Unknown exception';   // mensaje de excepci贸n
    private   $string;                          // cach茅 de __toString
    protected $code = 0;                        // c贸digo de excepci贸n definido por el usuario
    protected $file;                            // nombre de archivo fuente de la excepci贸n
    protected $line;                            // l铆nea fuente de la excepci贸n
    private   $trace;                           // determinaci贸n del origen
    private   $previous;                        // excepci贸n previa si la excepci贸n est谩 anidada

    public function __construct($message = null, $code = 0, Exception $previous = null);

    final private function __clone();           // Inhibe la clonaci贸n de excepciones.

    final public  function getMessage();        // mensaje de excepci贸n
    final public  function getCode();           // c贸digo de excepci贸n
    final public  function getFile();           // nombre de archivo fuente
    final public  function getLine();           // l铆nea fuente
    final public  function getTrace();          // un array de backtrace()
    final public  function getPrevious();       // excepci贸n anterior
    final public  function getTraceAsString();  // string formateado del seguimiento del origen

    // Sobrescribible
    public function __toString();               // string formateado para mostrar
}
```

>  _Al igual que en otros lenguajes de programacion en PHP podemos lanzar excepciones (`thrown`) y capturarlas (`catch`)._

> _Para poder cazarlas el codigo debe ejecutarse dentro de un bloque `try`. En caso de capturar una excepcion se ejecutara el `catch` correspondiente, y de estar definido el `finally` tenga o no excepcion._

##  驴Qu茅 es una excepci贸n?

Una excepci贸n es un objeto que describe un error o un comportamiento inesperado de un script PHP.

Las excepciones son lanzadas por muchas funciones y clases de PHP.

Las funciones y clases definidas por el usuario tambi茅n pueden lanzar excepciones.

Las excepciones son una buena manera de detener una funci贸n cuando se encuentra con datos que no puede utilizar.

Lanzando una Excepci贸n (`exception`)

La sentencia `throw` permite a una funci贸n o m茅todo definido por el usuario lanzar una excepci贸n. Cuando se lanza una excepci贸n, el c贸digo que la sigue no se ejecuta.

Si una excepci贸n no es capturada, se producir谩 un error fatal con el mensaje "`Uncaught Exception`".

Intentemos lanzar una excepci贸n sin atraparla:

```php
function divide($dividendo, $divisor) {
  if($divisor == 0) {
    throw new Exception("Division by zero");
  }
  return $dividendo / $divisor;
}

echo divide(5, 0);
```

El resultado ser谩 algo parecido a esto:

```php
Fatal error: Uncaught Exception: Division by zero in C:\webfolder\test.php:4
Stack trace: #0 C:\webfolder\test.php(9):
divide(5, 0) #1 {main} thrown in C:\webfolder\test.php on line 4
```

##  La sentencia `try ... catch`

Para evitar el error del ejemplo anterior, podemos utilizar la sentencia `try...catch` para atrapar excepciones y continuar el proceso.

 **Sintaxis:**
```php
try {
  code that can throw exceptions
} catch(Exception $e) {
  code that runs when an exception is caught
}
```

**Ejemplo**

Mostrar un mensaje cuando se lanza una excepci贸n:

```php
function divide($dividend, $divisor) {
  if($divisor == 0) {
    throw new Exception("Division by zero");
  }
  return $dividend / $divisor;
}

try {
  echo divide(5, 0);
} catch(Exception $e) {
  echo "Unable to divide.";
}
```

El bloque `catch` indica qu茅 tipo de excepci贸n debe ser capturada y el nombre de la variable que puede ser utilizada para acceder a la excepci贸n. En el ejemplo anterior, el tipo de excepci贸n es `Exception` y el nombre de la variable es `$e`.

##  La sentencia `try...catch...finally`

La sentencia `try...catch...finally` puede utilizarse para capturar excepciones. El c贸digo en el bloque `finally` siempre se ejecutar谩 independientemente de si se ha capturado una excepci贸n. Si el bloque `finally` est谩 presente, el bloque catch es opcional.

 **Sintaxis:**
```php
try {
  code that can throw exceptions
} catch(Exception $e) {
  code that runs when an exception is caught
} finally {
  code that always runs regardless of whether an exception was caught
}
```

**Ejemplo**

Mostrar un mensaje cuando se lanza una excepci贸n y luego indicar que el proceso ha terminado:

```php
function divide($dividend, $divisor) {
  if($divisor == 0) {
    throw new Exception("Division by zero");
  }
  return $dividend / $divisor;
}

try {
  echo divide(5, 0);
} catch(Exception $e) {
  echo "Unable to divide. ";
} finally {
  echo "Process complete.";
}
```

**Ejemplo**

Imprimir una cadena aunque no se haya capturado una excepci贸n:

```php
function divide($dividend, $divisor) {
  if($divisor == 0) {
    throw new Exception("Division by zero");
  }
  return $dividend / $divisor;
}

try {
  echo divide(5, 0);
} finally {
  echo "Process complete.";
}
```

## El objeto de excepci贸n

El objeto de excepci贸n contiene informaci贸n sobre el error o el comportamiento inesperado que ha encontrado la funci贸n.

 **Sintaxis:**
```php
new Exception(mensaje, c贸digo, anterior)
```

### Valores de los par谩metros
| Par谩metro | Descripci贸n |
|-----------|-------------|
| `message` | _Opcional._ Una cadena que describe por qu茅 se lanz贸 la excepci贸n |
| `code`    | _Opcional._ Un n煤mero entero que puede utilizarse para distinguir f谩cilmente esta excepci贸n de otras del mismo tipo |
| `previous` | _Opcional._ Si esta excepci贸n fue lanzada en un bloque `catch` de otra excepci贸n, se recomienda pasar esa excepci贸n en este par谩metro |

### M茅todos

Cuando se atrapa una excepci贸n, la siguiente tabla muestra algunos de los m茅todos que se pueden utilizar para obtener informaci贸n sobre la excepci贸n:

| M茅todo | Descripci贸n |
|--------|-------------|
| `getMessage()`| Devuelve una cadena que describe el motivo de la excepci贸n lanzada |
| `getPrevious()`|  Si esta excepci贸n fue lanzada por otra, este m茅todo devuelve la excepci贸n anterior. Si no, devuelve `null` |
| `getCode()`|  Devuelve el c贸digo de la excepci贸n |
| `getFile()`|  Devuelve la ruta completa del archivo en el que se lanz贸 la excepci贸n |
| `getLine()`|  Devuelve el n煤mero de l铆nea de la l铆nea de c贸digo que lanz贸 la excepci贸n |

**Ejemplo**

Devuelve informaci贸n sobre una excepci贸n lanzada:

```php
function divide($dividend, $divisor) {
  if($divisor == 0) {
    throw new Exception("Division by zero", 1);
  }
  return $dividend / $divisor;
}

try {
  echo divide(5, 0);
} catch(Exception $ex) {
  $code = $ex->getCode();
  $message = $ex->getMessage();
  $file = $ex->getFile();
  $line = $ex->getLine();
  echo "Exception thrown in $file on line $line: [Code $code]
  $message";
}
```
